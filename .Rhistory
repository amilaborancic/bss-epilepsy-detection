hop <- get_clust_tendency(data,n = nrow(data) -1 ,graph = FALSE)
hop$hopkins_stat
seed(123)
set.seed(123)
#hopkins statistika za dataset
?sample
#hopkins statistika za dataset
hop <- get_clust_tendency(data,n = 50 ,graph = FALSE)
hop$hopkins_stat
?ClusterR
??ClusterR
??partitions
?cluster
??cluster
?BBmisc
??BBmisc
library(dbscan) #fNN funckija - fixed nearest neighbors
library(partitions)
library(cluster)
library(factoextra) #fviz
library(BBmisc)
library(ClusterR) #external validation
library(NbClust)
library(stats)
##pomocna funkcija
update <- function(nbrs, pt_id, seeds, visited, rdist, coredist){
#nbrs - data frame sa kolonama id and dist
#pt_id - brojac
#visited - boolean vektor
#rdist - vektor reachability udaljenosti
#coredist - vektor core udaljenosti
while(nrow(nbrs) != 0){
#krenemo od zadnjeg reda
id <- nbrs[nrow(nbrs),]$id
dist <- nbrs[nrow(nbrs),]$dist
#uklanjanje iz nbrs
nbrs <- nbrs[-nrow(nbrs),]
if(nrow(nbrs)!=0) rownames(nbrs) <- c(1:nrow(nbrs)) #restartuje se numerisanje redova
if(visited[id]) next
newReachDist <- max(coredist[pt_id], dist)
if(rdist[id] == Inf){
rdist[id] <- newReachDist
seeds[length(seeds)+1] <- id
}
else if(newReachDist < rdist[id]){
rdist[id] <- newReachDist
}
}
return(list(nbrs, seeds, rdist, coredist))
}
#implementacija optics-a
OPTICS <- function(x, eps, minPts){
visited <- rep(FALSE, nrow(x))
orderedPts <- c()
rdist <- rep(Inf, nrow(x))
coredist <- rep(Inf, nrow(x))
neighbors <- frNN(x, eps) #izracunavanje najblizih susjeda za dist <= eps
seeds <- c() #prazan vektor cijelih brojeva
#inf je koristeno kao UNDEFINED
for(i in 1:nrow(x)){
if(visited[i]) next
#kreira se data frame za komsije i-te instance
pt_neighbors <- data.frame(id=c(neighbors$id[[i]]), dist=c(neighbors$dist[[i]]))
visited[i] = TRUE #i-ta instanca je obradjena
#provjera da li je core point
if(nrow(pt_neighbors) >= minPts){
n_dist <- pt_neighbors$dist #pomocni vektor - ne zelimo sortirati stvarni
n_dist <- sort(n_dist)
coredist[i] <- n_dist[minPts] #updateuje se core distance
}
orderedPts[length(orderedPts)+1] <- i #id trenutne instance se doda u orderedPts
if(coredist[i] == Inf) next #ako je core distance nedefinisan, preskoci
#poziv update
u <- update(pt_neighbors, i, seeds, visited, rdist, coredist)
pt_neighbors <- u[[1]]
seeds <- u[[2]]
rdist <- u[[3]]
coredist <- u[[4]]
#prolazimo kroz seeds
while(length(seeds) != 0){
#trazenje najmanje udaljenosti da se simulira prioritetni red
tmp <- seeds[1]
for(p in seeds){
if(rdist[p] < rdist[tmp] || (rdist[p] == rdist[tmp] && tmp < p)) tmp = p
}
j <- tmp #brojac je je id instance s najmanjom distancom
seeds <- seeds[which(seeds != j)] #uklanjanje j iz seeds
#sada se iz neighbors izvuku komsije od instance j
q_neighbors <- data.frame(id=c(neighbors$id[[j]]), dist=c(neighbors$dist[[j]]))
visited[j] = TRUE
#update core distance (isto kao za pt)
if(nrow(q_neighbors) >= minPts){
n_dist <- q_neighbors$dist
n_dist <- sort(n_dist)
coredist[j] <- n_dist[minPts]
}
orderedPts[length(orderedPts)+1] <- j
if(coredist[j] == Inf) next
#poziva se update
u <- update(q_neighbors, j, seeds, visited, rdist, coredist)
q_neighbors <- u[[1]]
seeds <- u[[2]]
rdist <- u[[3]]
coredist <- u[[4]]
}
}
#results
result = data.frame(order=c(orderedPts), reachdist=c(rdist), coredist=c(coredist))
class(result) <- "optics"
return(result)
}
ds <- read.csv(file.choose())
ds <- na.omit(ds)
ds <- normalize(ds, range=c(0,1))
str(ds)
colnames(ds)
nrow(ds)
hop <- get_clust_tendency(data,n = 50 ,graph = FALSE)
hop$hopkins_stat
#poziv optics (traje oko 1-2 min jer je velik dataset), a kod nije optimizovan
life_o <- OPTICS(data, eps = 2, minPts=15)
life_clust <- extractDBSCAN(life_o, 2)
life_plot <- list(data=data, cluster=life_clust$cluster)
fviz_cluster(life_plot)
?dunn
??dunn
install.packages("clv")
library(clv)
?Dunn
??dunn
install.packages("mlr")
library(mlr)
dunn(dist(data, method="euclidean"), life_clust$cluster)
??dunn
install.packages("clValid")
library(clValid)
clValid::dunn(dist(data, method="euclidean"), life_clust$cluster)
clValid::dunn(life_clust$cluster, Data=data)
clValid::dunn(clusters=life_clust$cluster, Data=data)
str(data)
clValid::dunn(distance = NULL, clusters=life_clust$cluster, Data = data, method = "euclidean")
life_clust$cluster
na.omit(life_clust$cluster)
dunny <- clValid::dunn(distance = NULL, clusters=life_clust$cluster, Data = data, method = "euclidean")
dunny
install.packages("arules")
install.packages("arulesViz")
library(arules)
library(arulesViz)
data(Groceries)
data(Adult)
?Groceries
class(Groceries)
inspect(Groceries)
class(Groceries)
str(Groceries)
Groceris@itemsetInfo
Groceries@itemsetInfo
apriori(Groceries, parameter=list(minlen=1, maxlen=1, support=0.15, target="frequent itemsets"))
inspect(sort(itemsets, by="support"))
itemsets <- apriori(Groceries, parameter=list(minlen=1, maxlen=1, support=0.15, target="frequent itemsets"))
inspect(sort(itemsets, by="support"))
itemsets_2 <- apriori(Groceries, parameter=list(minlen=2, maxlen=2, support=0.03, target="frequent itemsets"))
inspect(itemsets_2)
plot(itemsets_2, method="graph", control=list(type="items"))
?eclat
itemsets_3 <- eclat(Adult, parameter=list(minlen=3, supp=0.7))
inspect(itemsets_3
)
plot(itemsets_3, method="graph", control=list(type="items"))
getwd()
getwd()
setwd("...")
getwd()
setwd("bss-epilepsy-detection")
setwd("Desktop/bss-epilepsy-detection")
setwd("../Desktop/bss-epilepsy-detection")
setwd("~/Desktop/bss-epilepsy-detection")
Desktop\bss-epilepsy-det
setwd("C://Users/USER/Desktop/bss-epilepsy-detection")
getwd()
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL", header=T)
#izdvojimo 100 od 500 ispitanika
nrow(data_original)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
nrow(data_original)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[2300, ]
nrow(data_reduced)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
nrow(data_reduced)
print(data_reduced)
colnames(data_reduced)
#sredimo nazive kolona radi lakšeg snalaženja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
colnames(data_reduced)
print(data_reduced)
ncol(data_reduced)
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
data_reduced <- data_original[1:2300, ]
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
library(e1071)
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_reduced<-lapply(data_reduced[1:178], min_max_norm)
data_reduced$Klasa<-factor(data_reduced$Klasa)
svmfit = svm(Klasa ~ ., data = data_reduced, kernel = "linear", cost = 10, scale = FALSE)
data_reduced
svmfit = svm(Klasa ~ ., data = data_reduced, kernel = "linear", cost = 10, scale = FALSE)
data_reduced$Klasa
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_reduced<-lapply(data_reduced[1:178], min_max_norm)
svmfit = svm(Klasa ~ ., data = data_reduced, kernel = "linear", cost = 10, scale = FALSE)
svmfit = svm(as.factor(Klasa) ~ ., data = data_reduced, kernel = "linear", cost = 10, scale = FALSE)
data_reduced[, 'Klasa'] <- as.factor(data_reduced[, 'Klasa'])
data_reduced$Klasa<-factor(data_reduced$Klasa)
factor(data_reduced)
data_reduced
View(data_reduced)
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
View(data_reduced)
data_reduced$Klasa
levels(data_reduced$Klasa)
as.factor(data_reduced$Klasa)
data_reduced
levels(data_reduced$Klasa)
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_reduced<-lapply(data_reduced[1:178], min_max_norm)
data_reduced["Klasa"] <- lapply(data_reduced["Klasa"], as.factor)
svmfit = svm(Klasa ~ ., data = data_reduced, kernel = "linear", cost = 10, scale = FALSE)
data_reduced
data_reduced$Klasa
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_reduced<-lapply(data_reduced[1:178], min_max_norm)
data_reduced
data_reduced["Klasa"]
View(data_reduced)
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
View(data_reduced)
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_reduced<-lapply(data_reduced[1:178], min_max_norm)
View(data_reduced)
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_reduced<-lapply(data_reduced[,1:178], min_max_norm)
View(data_reduced)
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
data_reduced$Klasa
data_reduced$Klasa[data_reduced$Klasa==2]<-0
data_reduced
data_reduced$Klasa
#zakomentarisati
setwd("C://Users/USER/Desktop/bss-epilepsy-detection")
data_reduced$Klasa[data_reduced$Klasa==2 || data_reduced$Klasa==3 ]<-0
data_reduced$Klasa[data_reduced$Klasa==2 || data_reduced$Klasa==3 || data_reduced$Klasa==4 || data_reduced$Klasa==5]<-0
data_reduced$Klasa
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
data_reduced$Klasa
data_reduced$Klasa[data_reduced$Klasa==2 || data_reduced$Klasa==3 || data_reduced$Klasa==4 || data_reduced$Klasa==5]<-0
data_reduced$Klasa
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
data_reduced$Klasa[data_reduced$Klasa==2]<-0
data_reduced$Klasa
data_reduced$Klasa[data_reduced$Klasa==3]<-0
data_reduced$Klasa[data_reduced$Klasa==4]<-0
data_reduced$Klasa
data_reduced$Klasa[data_reduced$Klasa==5]<-0
data_reduced$Klasa
data_reduced["Klasa"] <- lapply(data_reduced["Klasa"], as.factor)
levels(data_reduced$Klasa)
svmfit = svm(Klasa ~ ., data = data_reduced, kernel = "linear", cost = 10, scale = FALSE)
svmfit
plot(svmfit,data_reduced)
plot(svmfit,data_reduced)
plot(svmfit)
plot(svmfit,data)
plot(svmfit,data)
plot(svmfit,data_reduced$Klasa)
levels(data_reduced$Klasa)
plot(svmft,data=data_reduced)
plot(svmfit,data=data_reduced)
plot(data_reduced)
plot(svmfit,data_reduced[,1:2])
data_reduced
data_reduced$Klasa
plot(svmfit,data_reduced,x~y)
plot(svmfit,data_reduced,X1~X2)
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_reduced[,1:2]
data_reduced$Klasa[data_reduced$Klasa==2]<-0
data_reduced$Klasa[data_reduced$Klasa==3]<-0
data_reduced$Klasa[data_reduced$Klasa==4]<-0
data_reduced$Klasa[data_reduced$Klasa==5]<-0
data_reduced["Klasa"] <- lapply(data_reduced["Klasa"], as.factor)
svmfit = svm(Klasa ~ ., data = data_reduced[,1:2], kernel = "linear", cost = 10, scale = FALSE)
library(e1071)
svmfit = svm(Klasa ~ ., data = data_reduced[,1:2], kernel = "linear", cost = 10, scale = FALSE)
data_reduced["Klasa"] <- lapply(data_reduced["Klasa"], as.factor)
svmfit = svm(Klasa ~ ., data = data_reduced[,1:2], kernel = "linear", cost = 10, scale = FALSE)
library(e1071)
svmfit = svm(Klasa ~ ., data = data_reduced[,1:3], kernel = "linear", cost = 10, scale = FALSE)
data_reduced
y<-data_reduced["Klasa"]
x<-data[,1:2]
data<-data.frame(x=x,y=as.factor(y))
svmfit = svm(y ~ ., data = data, kernel = "linear", cost = 10, scale = FALSE)
y
data
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_reduced<-lapply(data_reduced[,1:178], min_max_norm)
data_reduced$Klasa[data_reduced$Klasa==2]<-0
data_reduced$Klasa[data_reduced$Klasa==3]<-0
data_reduced$Klasa[data_reduced$Klasa==4]<-0
data_reduced$Klasa[data_reduced$Klasa==5]<-0
y<-data_reduced["Klasa"]
x<-data[,1:2]
data<-data.frame(x=x,y=as.factor(y))
svmfit = svm(y ~ ., data = data, kernel = "linear", cost = 10, scale = FALSE)
data
x<-data[,1:2]
data<-data.frame(x=x,data_reduced["Klasa"])
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
data_reduced$Klasa[data_reduced$Klasa==2]<-0
data_reduced$Klasa[data_reduced$Klasa==3]<-0
data_reduced$Klasa[data_reduced$Klasa==4]<-0
data_reduced$Klasa[data_reduced$Klasa==5]<-0
data_reduced["Klasa"] <- lapply(data_reduced["Klasa"], as.factor)
x<-data[,1:2]
data<-data.frame(x=x,data_reduced["Klasa"])
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
data_reduced$Klasa[data_reduced$Klasa==2]<-0
data_reduced$Klasa[data_reduced$Klasa==3]<-0
data_reduced$Klasa[data_reduced$Klasa==4]<-0
data_reduced$Klasa[data_reduced$Klasa==5]<-0
data_reduced$Klasa
data_reduced["Klasa"] <- lapply(data_reduced["Klasa"], as.factor)
y<-data_reduced["Klasa"]
y
x<-data[,1:2]
x
data<-data.frame(x=x,y=y)
nrow(x)
nrow(y)
data_reduced
svmfit = svm(Klasa ~ ., data = data[,c("X1","X2","Klasa")], kernel = "linear", cost = 10, scale = FALSE)
svmfit = svm(Klasa ~ ., data = data_reduced[,c("X1","X2","Klasa")], kernel = "linear", cost = 10, scale = FALSE)
svmfit
plot(svmfit,data_reduced[,c("X1","X2","Klasa")])
plot(svmfit,data)
library(e1071)
#ucitavanje dataseta
data_original <- read.csv("EpilepticSeizureRecognitionORIGINAL.csv", header=T)
#izdvojimo 100 od 500 ispitanika
data_reduced <- data_original[1:2300, ]
#sredimo nazive kolona radi lakseg snalazenja
names(data_reduced)[names(data_reduced) == "y"] <- "Klasa"
data_reduced <- data_reduced[,-1]
#spasimo novi dataset
write.csv(data_reduced,'EpilepticSeizureRecognitionREDUCED.csv')
data_reduced$Klasa[data_reduced$Klasa==2]<-0
data_reduced$Klasa[data_reduced$Klasa==3]<-0
data_reduced$Klasa[data_reduced$Klasa==4]<-0
data_reduced$Klasa[data_reduced$Klasa==5]<-0
data_reduced["Klasa"] <- lapply(data_reduced["Klasa"], as.factor)
data<-data_reduced[,c("X1","X2","Klasa")]
svmfit = svm(Klasa ~ ., data = data, kernel = "linear", cost = 10, scale = FALSE)
plot(svmfit,data)
